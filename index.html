<!DOCTYPE html>
<html>

<head>
    <title>Story Generator</title>
    <style>
        body {
            font-family: sans-serif;
            padding: 20px;
        }

        #prompt {
            width: 80%;
            padding: 10px;
            margin-bottom: 10px;
        }

        button {
            padding: 10px 15px;
            cursor: pointer;
        }

        #storyOutput {
            margin-top: 20px;
            border: 1px solid #ccc;
            padding: 15px;
            min-height: 100px;
            background-color: #f9f9f9;
        }

        .error {
            color: red;
            font-weight: bold;
        }
    </style>
</head>

<body>
    <h1>Story Generator</h1>
    <p>Enter a prompt and I'll write a story!</p>

    <textarea id="prompt" rows="3" placeholder="e.g., A brave knight searching for a lost dragon..."></textarea><br>
    <button onclick="generateStory()">Generate Story</button>

    <h2>Generated Story:</h2>
    <div id="storyOutput">Your story will appear here...</div>

    <script>
        // --- Configuration ---
        // IMPORTANT: Replace 'YOUR_API_KEY' with your actual Gemini API key.
        // SECURITY WARNING: Exposing your API key in client-side code is insecure.
        // For production, use a backend proxy to handle API calls.
        const API_KEY = 'AIzaSyAVmReDE9dcvDw2F9IxFxeRXmqezNvOrEw';
        // Adjust the model name if needed (e.g., 'gemini-pro')
        const MODEL_NAME = 'gemini-1.5-flash'; // Or another suitable model
        const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_NAME}:generateContent?key=${API_KEY}`;

        async function generateStory() {
            const promptInput = document.getElementById('prompt');
            const storyOutput = document.getElementById('storyOutput');
            const userPrompt = promptInput.value.trim();

            if (!userPrompt) {
                storyOutput.innerHTML = '<p class="error">Please enter a prompt.</p>';
                return;
            }

            if (API_KEY === 'YOUR_API_KEY') {
                storyOutput.innerHTML = '<p class="error">Please replace "YOUR_API_KEY" with your actual Gemini API key in the script section.</p>';
                return;
            }

            storyOutput.innerHTML = 'Generating story... Please wait.';

            try {
                const response = await fetch(API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        // Construct the prompt for the API
                        "contents": [{
                            "parts": [{
                                "text": `Write a short story based on the following prompt: ${userPrompt}`
                            }]
                        }],
                        // Optional: Add generation config (temperature, max tokens, etc.)
                        // "generationConfig": {
                        //   "temperature": 0.7,
                        //   "maxOutputTokens": 500
                        // }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('API Error:', errorData);
                    throw new Error(`API request failed with status ${response.status}: ${errorData.error?.message || 'Unknown error'}`);
                }

                const data = await response.json();

                // Extract the generated text - structure might vary slightly based on model/response
                if (data.candidates && data.candidates[0] && data.candidates[0].content && data.candidates[0].content.parts && data.candidates[0].content.parts[0]) {
                    const generatedText = data.candidates[0].content.parts[0].text;
                    // Basic formatting: replace newlines with <br> tags
                    storyOutput.innerHTML = generatedText.replace(/\n/g, '<br>');
                } else {
                    console.error('Unexpected API response structure:', data);
                    storyOutput.innerHTML = '<p class="error">Could not extract story from API response.</p>';
                }

            } catch (error) {
                console.error('Error generating story:', error);
                storyOutput.innerHTML = `<p class="error">An error occurred: ${error.message}</p>`;
            }
        }
    </script>
</body>

</html>